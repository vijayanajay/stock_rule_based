============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-8.4.0, pluggy-1.6.0 -- D:\Code\stock_rule_based\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Code\stock_rule_based
configfile: pyproject.toml
plugins: cov-6.2.1
collecting ... collected 459 items

test_frequency_fix.py::test_frequency_fix PASSED                         [  0%]
tests/test_adapters.py::TestFetchSymbolData::test_successful_fetch_basic PASSED [  0%]
tests/test_adapters.py::TestFetchSymbolData::test_successful_fetch_with_freeze_date PASSED [  0%]
tests/test_adapters.py::TestFetchSymbolData::test_multiindex_columns_handling PASSED [  0%]
tests/test_adapters.py::TestFetchSymbolData::test_tuple_columns_handling PASSED [  1%]
tests/test_adapters.py::TestFetchSymbolData::test_empty_dataframe_first_attempt_success_second PASSED [  1%]
tests/test_adapters.py::TestFetchSymbolData::test_empty_dataframe_all_attempts PASSED [  1%]
tests/test_adapters.py::TestFetchSymbolData::test_missing_required_columns PASSED [  1%]
tests/test_adapters.py::TestFetchSymbolData::test_yftzmissingerror_retry_then_success PASSED [  1%]
tests/test_adapters.py::TestFetchSymbolData::test_yftzmissingerror_all_attempts_fail PASSED [  2%]
tests/test_adapters.py::TestFetchSymbolData::test_timeout_error_retry_logic PASSED [  2%]
tests/test_adapters.py::TestFetchSymbolData::test_connection_error_retry_logic PASSED [  2%]
tests/test_adapters.py::TestFetchSymbolData::test_404_error_no_retry PASSED [  2%]
tests/test_adapters.py::TestFetchSymbolData::test_delisted_error_no_retry PASSED [  3%]
tests/test_adapters.py::TestFetchSymbolData::test_generic_error_no_retry PASSED [  3%]
tests/test_adapters.py::TestFetchSymbolData::test_data_type_conversion PASSED [  3%]
tests/test_adapters.py::TestFetchSymbolData::test_invalid_numeric_data_handling PASSED [  3%]
tests/test_adapters.py::TestFetchSymbolData::test_exponential_backoff_delays PASSED [  3%]
tests/test_adapters.py::TestFetchSymbolData::test_max_retries_reached PASSED [  4%]
tests/test_adapters.py::TestFetchSymbolData::test_different_years_parameter PASSED [  4%]
tests/test_adapters.py::TestFetchSymbolData::test_progress_parameter_disabled PASSED [  4%]
tests/test_adapters.py::TestFetchSymbolData::test_auto_adjust_parameter PASSED [  4%]
tests/test_adapters.py::TestFetchSymbolData::test_logger_import_and_usage PASSED [  5%]
tests/test_adapters.py::TestFetchSymbolData::test_time_import_and_usage PASSED [  5%]
tests/test_adapters.py::TestFetchSymbolData::test_column_standardization_edge_cases PASSED [  5%]
tests/test_adapters.py::TestFetchSymbolData::test_return_none_final_attempt PASSED [  5%]
tests/test_adapters.py::TestFetchSymbolData::test_function_signature_and_defaults PASSED [  5%]
tests/test_adapters.py::TestFetchSymbolData::test_coverage_all_error_classification_branches PASSED [  6%]
tests/test_adapters.py::TestFetchSymbolData::test_final_return_none_path PASSED [  6%]
tests/test_adapters.py::TestFetchSymbolData::test_unreachable_return_none_coverage PASSED [  6%]
tests/test_adapters.py::TestFetchSymbolData::test_theoretical_unreachable_path PASSED [  6%]
tests/test_adapters.py::TestFetchSymbolData::test_coverage_summary PASSED [  6%]
tests/test_backtester.py::TestBacktesterCore::test_init_default_parameters PASSED [  7%]
tests/test_backtester.py::TestBacktesterCore::test_init_custom_parameters PASSED [  7%]
tests/test_backtester.py::TestBacktesterCore::test_generate_signals_empty_type_field PASSED [  7%]
tests/test_backtester.py::TestBacktesterCore::test_generate_signals_various_rules[sma_crossover-params0] PASSED [  7%]
tests/test_backtester.py::TestBacktesterCore::test_generate_signals_various_rules[ema_crossover-params1] PASSED [  8%]
tests/test_backtester.py::TestBacktesterCore::test_generate_signals_various_rules[rsi_oversold-params2] PASSED [  8%]
tests/test_backtester.py::TestBacktesterCore::test_generate_signals_various_rules[volume_spike-params3] PASSED [  8%]
tests/test_backtester.py::TestBacktesterCore::test_calculate_edge_score_basic PASSED [  8%]
tests/test_backtester.py::TestBacktesterCore::test_calculate_edge_score_with_weights PASSED [  8%]
tests/test_backtester.py::TestBacktesterCore::test_backtest_strategy_end_to_end PASSED [  9%]
tests/test_backtester.py::TestContextFilters::test_apply_context_filters_empty_list PASSED [  9%]
tests/test_backtester.py::TestContextFilters::test_apply_context_filters_single_filter PASSED [  9%]
tests/test_backtester.py::TestContextFilters::test_apply_context_filters_multiple_filters PASSED [  9%]
tests/test_backtester.py::TestContextFilters::test_context_filter_initialization_fix PASSED [ 10%]
tests/test_backtester.py::TestContextFilters::test_context_filter_integration_with_backtest PASSED [ 10%]
tests/test_backtester.py::TestPandasDowncasting::test_no_future_warnings_on_import PASSED [ 10%]
tests/test_backtester.py::TestPandasDowncasting::test_apply_context_filters_no_warnings PASSED [ 10%]
tests/test_backtester.py::TestPandasDowncasting::test_generate_signals_no_warnings PASSED [ 10%]
tests/test_backtester.py::TestPandasDowncasting::test_portfolio_operations_no_warnings PASSED [ 11%]
tests/test_backtester.py::TestCompleteRuleStack::test_rule_stack_includes_entry_signals PASSED [ 11%]
tests/test_backtester.py::TestCompleteRuleStack::test_rule_stack_includes_all_entry_signals PASSED [ 11%]
tests/test_backtester.py::TestCompleteRuleStack::test_rule_stack_includes_context_filters PASSED [ 11%]
tests/test_backtester.py::TestCompleteRuleStack::test_rule_stack_includes_sell_conditions PASSED [ 11%]
tests/test_backtester.py::TestCompleteRuleStack::test_rule_stack_complete_configuration PASSED [ 12%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_basic_flow PASSED [ 12%]
tests/test_backtester.py::TestBacktesterIntegration::test_backtest_combination_direct_coverage PASSED [ 12%]
tests/test_backtester.py::TestBacktesterIntegration::test_generate_exit_signals_multiple_stop_loss PASSED [ 12%]
tests/test_backtester.py::TestBacktesterIntegration::test_generate_exit_signals_multiple_take_profit PASSED [ 13%]
tests/test_backtester.py::TestBacktesterIntegration::test_generate_exit_signals_indicator_rule_exception PASSED [ 13%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_no_baseline_rule PASSED [ 13%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_simplified_workflow PASSED [ 13%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_basic_execution PASSED [ 13%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_clean_execution PASSED [ 14%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_with_sell_conditions_logging PASSED [ 14%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_empty_signals PASSED [ 14%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_zero_trades_after_signals PASSED [ 14%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_total_trades_zero PASSED [ 15%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_exception_in_processing PASSED [ 15%]
tests/test_backtester.py::TestBacktesterFixtures::test_sample_backtest_data_fixture PASSED [ 15%]
tests/test_backtester.py::TestBacktester::test_init_default_parameters PASSED [ 15%]
tests/test_backtester.py::TestBacktester::test_init_custom_parameters PASSED [ 15%]
tests/test_backtester.py::TestBacktester::test_generate_signals_empty_type_field PASSED [ 16%]
tests/test_backtester.py::TestBacktester::test_generate_signals_sma_crossover PASSED [ 16%]
tests/test_backtester.py::TestBacktester::test_generate_signals_invalid_rule PASSED [ 16%]
tests/test_backtester.py::TestBacktester::test_generate_signals_missing_parameters PASSED [ 16%]
tests/test_backtester.py::TestBacktester::test_find_optimal_strategies_no_trades PASSED [ 16%]
tests/test_backtester.py::TestBacktester::test_atr_exit_signal_generation PASSED [ 17%]
tests/test_backtester.py::TestBacktester::test_generate_exit_signals_with_atr PASSED [ 17%]
tests/test_backtester.py::TestBacktester::test_track_entry_prices PASSED [ 17%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_get_rolling_periods_empty_result PASSED [ 17%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_get_rolling_periods_edge_case_exact_fit PASSED [ 18%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_backtest_no_periods PASSED [ 18%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_backtest_empty_training_data PASSED [ 18%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_backtest_no_viable_strategy PASSED [ 18%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_backtest_empty_testing_data PASSED [ 18%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_single_strategy_oos_no_context_signals PASSED [ 19%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_single_strategy_oos_no_entry_signals PASSED [ 19%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_single_strategy_oos_insufficient_trades PASSED [ 19%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_duplicate_logic_bug_fix_integration PASSED [ 19%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_regression_duplicate_logic_bug_fix PASSED [ 20%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_single_strategy_oos_exception_handling PASSED [ 20%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_backtest_insufficient_trades_per_period PASSED [ 20%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_parse_period_invalid_inputs[] PASSED [ 20%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_parse_period_invalid_inputs[abc] PASSED [ 20%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_parse_period_invalid_inputs[123] PASSED [ 21%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_parse_period_invalid_inputs[30x] PASSED [ 21%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_parse_period_valid_inputs PASSED [ 21%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_no_valid_oos_periods PASSED [ 21%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_combination_precondition_failure PASSED [ 22%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_combination_context_filter_failure PASSED [ 22%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_combination_no_entry_signals PASSED [ 22%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_combination_portfolio_creation_error PASSED [ 22%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_backtest_combination_zero_valid_trades PASSED [ 22%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_walk_forward_exception_handling PASSED [ 23%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_period_parsing_coverage PASSED [ 23%]
tests/test_backtester.py::TestBacktesterEdgeCases::test_portfolio_calculation_edge_cases PASSED [ 23%]
tests/test_chandelier_vs_baseline.py::test_chandelier_vs_baseline_performance PASSED [ 23%]
tests/test_cli.py::test_run_command_help PASSED                          [ 23%]
tests/test_cli.py::test_show_banner PASSED                               [ 24%]
tests/test_cli.py::test_create_progress_context PASSED                   [ 24%]
tests/test_cli.py::test_display_results_empty PASSED                     [ 24%]
tests/test_cli.py::test_run_command_basic PASSED                         [ 24%]
tests/test_cli.py::test_run_command_verbose PASSED                       [ 25%]
tests/test_cli.py::test_run_command_freeze_date PASSED                   [ 25%]
tests/test_cli.py::test_run_command_invalid_freeze_date PASSED           [ 25%]
tests/test_cli.py::test_run_command_no_config PASSED                     [ 25%]
tests/test_cli.py::test_run_command_missing_rules PASSED                 [ 25%]
tests/test_cli.py::test_run_command_insufficient_data_handling PASSED    [ 26%]
tests/test_cli.py::test_run_command_with_persistence PASSED              [ 26%]
tests/test_cli.py::test_analyze_strategies_command_success PASSED        [ 26%]
tests/test_cli.py::test_analyze_strategies_command_no_data PASSED        [ 26%]
tests/test_cli.py::test_analyze_strategies_command_no_database PASSED    [ 27%]
tests/test_cli.py::test_clear_and_recalculate_basic_flow PASSED          [ 27%]
tests/test_cli.py::test_clear_and_recalculate_clear_failure PASSED       [ 27%]
tests/test_cli.py::test_run_command_backtest_generic_exception_verbose PASSED [ 27%]
tests/test_cli.py::test_exception_handling_variants PASSED               [ 27%]
tests/test_cli.py::test_cli_with_min_trades_config PASSED                [ 28%]
tests/test_cli.py::test_min_trades_filtering_applied PASSED              [ 28%]
tests/test_cli.py::test_check_exit_conditions_stop_loss PASSED           [ 28%]
tests/test_cli.py::test_check_exit_conditions_time_based PASSED          [ 28%]
tests/test_cli.py::test_calculate_position_returns_basic PASSED          [ 28%]
tests/test_cli.py::test_calculate_position_returns_invalid_entry PASSED  [ 29%]
tests/test_cli.py::test_identify_new_signals_filters PASSED              [ 29%]
tests/test_cli.py::test_process_open_positions_close PASSED              [ 29%]
tests/test_cli.py::test_process_open_positions_hold PASSED               [ 29%]
tests/test_cli.py::test_update_positions_and_generate_report_data PASSED [ 30%]
tests/test_cli.py::TestCLIIntegration::test_config_loading_integration PASSED [ 30%]
tests/test_cli.py::TestCLIIntegration::test_data_loading_integration PASSED [ 30%]
tests/test_cli.py::TestCLIIntegration::test_error_handling_integration PASSED [ 30%]
tests/test_cli.py::test_walk_forward_results_display PASSED              [ 30%]
tests/test_cli.py::test_save_command_log_error_handling PASSED           [ 31%]
tests/test_cli.py::test_analyze_symbol_exception_paths PASSED            [ 31%]
tests/test_cli.py::test_clear_and_recalculate_user_cancellation PASSED   [ 31%]
tests/test_cli.py::test_setup_logging_coverage PASSED                    [ 31%]
tests/test_cli.py::test_process_and_save_results_report_error PASSED     [ 32%]
tests/test_cli.py::test_insufficient_data_warnings PASSED                [ 32%]
tests/test_cli.py::test_parse_freeze_date_invalid PASSED                 [ 32%]
tests/test_cli.py::test_save_results_failure PASSED                      [ 32%]
tests/test_cli.py::test_save_results_exception PASSED                    [ 32%]
tests/test_cli.py::test_analyze_strategies_write_error PASSED            [ 33%]
tests/test_cli.py::test_clear_strategies_preserve_all PASSED             [ 33%]
tests/test_cli.py::test_save_command_log_normal_path PASSED              [ 33%]
tests/test_cli.py::test_display_results_with_rule_objects PASSED         [ 33%]
tests/test_config.py::test_config_model_valid PASSED                     [ 33%]
tests/test_config.py::test_config_model_invalid_weights PASSED           [ 34%]
tests/test_config.py::test_load_config_missing_file PASSED               [ 34%]
tests/test_config.py::test_config_universe_path_is_dir PASSED            [ 34%]
tests/test_config.py::test_load_config_invalid_yaml PASSED               [ 34%]
tests/test_config.py::test_load_config_empty_file PASSED                 [ 35%]
tests/test_config.py::test_load_rules_invalid_structure_pydantic[exit_conditions: []-entry_signals] PASSED [ 35%]
tests/test_config.py::test_load_rules_invalid_structure_pydantic[entry_signals: 123-Input should be a valid list] PASSED [ 35%]
tests/test_config.py::test_load_rules_invalid_structure_pydantic[entry_signals: [{}]-Field required] PASSED [ 35%]
tests/test_config.py::test_load_rules_invalid_structure_pydantic[entry_signals: [{name: a, type: b}]-Field required] PASSED [ 35%]
tests/test_config.py::test_load_rules_missing_file PASSED                [ 36%]
tests/test_config.py::test_load_rules_invalid_yaml PASSED                [ 36%]
tests/test_config.py::test_load_rules_empty_file PASSED                  [ 36%]
tests/test_config.py::test_rules_config_with_context_filters PASSED      [ 36%]
tests/test_config.py::test_rules_config_without_context_filters PASSED   [ 37%]
tests/test_config.py::test_rules_config_with_preconditions PASSED        [ 37%]
tests/test_config.py::test_rules_config_without_preconditions PASSED     [ 37%]
tests/test_data.py::TestDataBasicOperations::test_load_universe PASSED   [ 37%]
tests/test_data.py::TestDataBasicOperations::test_load_universe_missing_file PASSED [ 37%]
tests/test_data.py::TestDataBasicOperations::test_load_universe_malformed PASSED [ 38%]
tests/test_data.py::TestDataBasicOperations::test_add_ns_suffix PASSED   [ 38%]
tests/test_data.py::TestDataBasicOperations::test_needs_refresh[False-True] PASSED [ 38%]
tests/test_data.py::TestDataBasicOperations::test_needs_refresh[True-False] PASSED [ 38%]
tests/test_data.py::TestDataBasicOperations::test_needs_refresh[True-True] PASSED [ 38%]
tests/test_data.py::TestDataBasicOperations::test_needs_refresh_os_error PASSED [ 39%]
tests/test_data.py::TestDataBasicOperations::test_validate_data_quality[good-True] PASSED [ 39%]
tests/test_data.py::TestDataBasicOperations::test_validate_data_quality[negative_prices-False] PASSED [ 39%]
tests/test_data.py::TestDataBasicOperations::test_validate_data_quality[zero_volume-False] PASSED [ 39%]
tests/test_data.py::TestDataBasicOperations::test_validate_data_quality[empty-False] PASSED [ 40%]
tests/test_data.py::TestDataBasicOperations::test_validate_data_quality[large_gap-False] PASSED [ 40%]
tests/test_data.py::TestCacheOperations::test_save_and_load_cache_cycle PASSED [ 40%]
tests/test_data.py::TestCacheOperations::test_save_cache_exception_handling PASSED [ 40%]
tests/test_data.py::TestCacheOperations::test_load_cache_format_variations[unnamed_col] PASSED [ 40%]
tests/test_data.py::TestCacheOperations::test_load_cache_format_variations[date_as_col] PASSED [ 41%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_scenarios[date_filtering] PASSED [ 41%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_scenarios[start_end_date] PASSED [ 41%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_scenarios[freeze_date] PASSED [ 41%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_scenarios[freeze_mode_no_cache] PASSED [ 42%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_scenarios[no_data_in_range] PASSED [ 42%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_limited_data_warnings[RELIANCE-True] PASSED [ 42%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_limited_data_warnings[^NSEI-False] PASSED [ 42%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_position_tracking_warnings[date_params0-True] PASSED [ 42%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_position_tracking_warnings[date_params1-True] PASSED [ 43%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_position_tracking_warnings[date_params2-True] PASSED [ 43%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_position_tracking_warnings[date_params3-False] PASSED [ 43%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_sufficient_data_no_warning PASSED [ 43%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_symbol_suffix_handling[BPCL-BPCL.NS] PASSED [ 44%]
tests/test_data.py::TestPriceDataRetrieval::test_get_price_data_symbol_suffix_handling[^NSEI-^NSEI] PASSED [ 44%]
tests/test_data.py::TestAdvancedDataOperations::test_get_price_data_missing_cache_fetches_new_data PASSED [ 44%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_freeze_mode_skips_download PASSED [ 44%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_success_creates_cache PASSED [ 44%]
tests/test_data.py::TestAdvancedDataOperations::test_fetch_symbol_data_column_handling[multiindex-True] PASSED [ 45%]
tests/test_data.py::TestAdvancedDataOperations::test_fetch_symbol_data_column_handling[tuple-True] PASSED [ 45%]
tests/test_data.py::TestAdvancedDataOperations::test_fetch_symbol_data_column_handling[missing-False] PASSED [ 45%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_failure_scenarios[download_failure] PASSED [ 45%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_failure_scenarios[validation_failure] PASSED [ 45%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_failure_scenarios[api_exception] PASSED [ 46%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_failure_scenarios[empty_dataframe] PASSED [ 46%]
tests/test_data.py::TestAdvancedDataOperations::test_refresh_market_data_with_symbol_list PASSED [ 46%]
tests/test_data.py::TestMarketDataAlignment::test_market_cache_preserves_datetime_index PASSED [ 46%]
tests/test_data.py::TestMarketDataAlignment::test_market_above_sma_handles_index_types[range] PASSED [ 47%]
tests/test_data.py::TestMarketDataAlignment::test_market_above_sma_handles_index_types[datetime] PASSED [ 47%]
tests/test_data.py::TestMarketDataAlignment::test_market_data_alignment_integration PASSED [ 47%]
tests/test_data.py::TestMarketDataAlignment::test_freeze_date_preserves_datetime_index PASSED [ 47%]
tests/test_data.py::TestMarketDataAlignment::test_alignment_signal_preservation PASSED [ 47%]
tests/test_data.py::TestMarketDataAlignment::test_problematic_csv_format_handling PASSED [ 48%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_index_conversion[string_dates] PASSED [ 48%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_index_conversion[numeric_index] PASSED [ 48%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_index_conversion[invalid_dates] PASSED [ 48%]
tests/test_data.py::TestTimestampComparison::test_load_cache_invalid_dates_error_handling PASSED [ 49%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_freeze_date_index_conversion PASSED [ 49%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_non_datetime_index_handling PASSED [ 49%]
tests/test_data.py::TestTimestampComparison::test_get_price_data_complex_filtering_with_conversion PASSED [ 49%]
tests/test_data.py::TestTimestampComparison::test_regression_nifty_comparison_error PASSED [ 49%]
tests/test_data.py::test_end_to_end_alignment_regression PASSED          [ 50%]
tests/test_integration_backtester.py::TestBacktesterRuleIntegration::test_rule_function_lookup PASSED [ 50%]
tests/test_integration_backtester.py::TestBacktesterRuleIntegration::test_rule_parameter_validation PASSED [ 50%]
tests/test_integration_backtester.py::TestBacktesterRuleIntegration::test_backtester_with_real_rules PASSED [ 50%]
tests/test_mathematical_accuracy.py::TestATRMathematicalAccuracy::test_atr_manual_calculation_simple PASSED [ 50%]
tests/test_mathematical_accuracy.py::TestATRMathematicalAccuracy::test_atr_boundary_conditions PASSED [ 51%]
tests/test_mathematical_accuracy.py::TestSMAMathematicalAccuracy::test_sma_manual_calculation PASSED [ 51%]
tests/test_mathematical_accuracy.py::TestSMAMathematicalAccuracy::test_sma_mathematical_properties PASSED [ 51%]
tests/test_mathematical_accuracy.py::TestSMAMathematicalAccuracy::test_sma_boundary_conditions PASSED [ 51%]
tests/test_mathematical_accuracy.py::TestMathematicalToleranceLevels::test_trading_tolerance_sufficient PASSED [ 52%]
tests/test_mathematical_accuracy.py::TestMathematicalToleranceLevels::test_precision_documentation PASSED [ 52%]
tests/test_performance.py::test_performance_monitor_context_manager PASSED [ 52%]
tests/test_performance.py::test_performance_monitor_decorator PASSED     [ 52%]
tests/test_performance.py::test_get_summary PASSED                       [ 52%]
tests/test_performance.py::test_get_summary_empty PASSED                 [ 53%]
tests/test_performance.py::test_duration_warning PASSED                  [ 53%]
tests/test_performance.py::test_global_monitor_instance PASSED           [ 53%]
tests/test_performance.py::test_performance_benchmark_simulation PASSED  [ 53%]
tests/test_persistence.py::TestCreateDatabase::test_create_database_success PASSED [ 54%]
tests/test_persistence.py::TestCreateDatabase::test_create_database_idempotent PASSED [ 54%]
tests/test_persistence.py::TestCreateDatabase::test_create_database_failure PASSED [ 54%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_success PASSED [ 54%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_empty_list PASSED [ 54%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_transaction_rollback PASSED [ 55%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_invalid_rule_stack PASSED [ 55%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_with_closed_connection PASSED [ 55%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_upsert_behavior PASSED [ 55%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_with_numpy_int PASSED [ 55%]
tests/test_persistence.py::TestGetOpenPositions::test_get_open_positions_success PASSED [ 56%]
tests/test_persistence.py::TestGetOpenPositions::test_get_open_positions_empty PASSED [ 56%]
tests/test_persistence.py::TestGetOpenPositions::test_get_open_positions_db_error PASSED [ 56%]
tests/test_persistence.py::TestClosePositionsBatch::test_close_positions_batch_success PASSED [ 56%]
tests/test_persistence.py::TestClosePositionsBatch::test_close_positions_batch_empty_list PASSED [ 57%]
tests/test_persistence.py::TestClosePositionsBatch::test_close_positions_batch_db_error PASSED [ 57%]
tests/test_persistence.py::TestAddPositions::test_add_new_position_skips_existing_open PASSED [ 57%]
tests/test_persistence.py::TestAddPositions::test_add_new_positions_empty_list PASSED [ 57%]
tests/test_persistence.py::TestAddPositions::test_add_new_positions_db_error PASSED [ 57%]
tests/test_persistence.py::TestAddPositions::test_save_strategies_multiple_batches PASSED [ 58%]
tests/test_persistence.py::TestIntegration::test_create_and_save_workflow PASSED [ 58%]
tests/test_persistence.py::TestMigrationV2::test_migrate_strategies_table_v2_fresh_database PASSED [ 58%]
tests/test_persistence.py::TestMigrationV2::test_migrate_strategies_table_v2_with_existing_data PASSED [ 58%]
tests/test_persistence.py::TestMigrationV2::test_migrate_strategies_table_v2_idempotent PASSED [ 59%]
tests/test_persistence.py::TestMigrationV2::test_config_functions PASSED [ 59%]
tests/test_persistence.py::TestGetConnectionEdgeCases::test_get_connection_with_migration_needed PASSED [ 59%]
tests/test_persistence.py::TestGetConnectionEdgeCases::test_get_connection_database_error PASSED [ 59%]
tests/test_persistence.py::TestGetConnectionEdgeCases::test_get_connection_already_migrated PASSED [ 59%]
tests/test_persistence.py::TestCreateDatabaseEdgeCases::test_create_database_parent_directory_creation PASSED [ 60%]
tests/test_persistence.py::TestCreateDatabaseEdgeCases::test_create_database_oserror PASSED [ 60%]
tests/test_persistence.py::TestConfigHashAndSnapshot::test_generate_config_hash_deterministic PASSED [ 60%]
tests/test_persistence.py::TestConfigHashAndSnapshot::test_generate_config_hash_different_configs PASSED [ 60%]
tests/test_persistence.py::TestConfigHashAndSnapshot::test_create_config_snapshot_with_freeze_date PASSED [ 61%]
tests/test_persistence.py::TestConfigHashAndSnapshot::test_create_config_snapshot_without_freeze_date PASSED [ 61%]
tests/test_persistence.py::TestSaveStrategiesBatchEdgeCases::test_save_strategies_batch_with_pydantic_models PASSED [ 61%]
tests/test_persistence.py::TestSaveStrategiesBatchEdgeCases::test_save_strategies_batch_assertion_errors PASSED [ 61%]
tests/test_persistence.py::TestAddNewPositionsFromSignalsEdgeCases::test_add_positions_with_rule_stack_json PASSED [ 61%]
tests/test_persistence.py::TestAddNewPositionsFromSignalsEdgeCases::test_add_positions_fallback_rule_stack PASSED [ 62%]
tests/test_persistence.py::TestMigrateStrategiesTableV2EdgeCases::test_migrate_v2_with_data_and_pragma_check PASSED [ 62%]
tests/test_persistence.py::TestMigrateStrategiesTableV2EdgeCases::test_migrate_v2_error_handling PASSED [ 62%]
tests/test_persistence.py::TestAdditionalPersistenceFunctions::test_close_positions_transaction_rollback PASSED [ 62%]
tests/test_persistence.py::TestAdditionalPersistenceFunctions::test_add_positions_transaction_rollback PASSED [ 62%]
tests/test_persistence.py::TestStory020Deduplication::test_deduplication_removes_duplicates PASSED [ 63%]
tests/test_persistence.py::TestStory020Deduplication::test_deduplication_keeps_latest_record PASSED [ 63%]
tests/test_persistence.py::TestStory020Deduplication::test_deduplication_preserves_unique_records PASSED [ 63%]
tests/test_persistence.py::TestStory020Deduplication::test_deduplication_different_strategies_same_symbol PASSED [ 63%]
tests/test_persistence.py::TestStory020Deduplication::test_story_020_acceptance_criteria PASSED [ 64%]
tests/test_persistence.py::TestClearCurrentStrategies::test_clear_current_strategies_with_matches PASSED [ 64%]
tests/test_persistence.py::TestClearCurrentStrategies::test_cleanup_duplicate_strategies PASSED [ 64%]
tests/test_persistence.py::TestClearCurrentStrategies::test_clear_current_strategies_no_matches PASSED [ 64%]
tests/test_position_sizing.py::test_position_sizing_volatility_impact PASSED [ 64%]
tests/test_position_sizing.py::test_risk_percentage_respected PASSED     [ 65%]
tests/test_position_sizing.py::test_no_division_by_zero PASSED           [ 65%]
tests/test_position_sizing.py::test_no_size_where_no_entry PASSED        [ 65%]
tests/test_position_sizing.py::test_position_sizing_with_nan_atr PASSED  [ 65%]
tests/test_reporter.py::TestStrategFetching::test_fetch_strategies_success PASSED [ 66%]
tests/test_reporter.py::TestStrategFetching::test_fetch_strategies_threshold_filtering PASSED [ 66%]
tests/test_reporter.py::TestStrategFetching::test_fetch_strategies_no_results PASSED [ 66%]
tests/test_reporter.py::TestStrategFetching::test_fetch_strategies_database_error PASSED [ 66%]
tests/test_reporter.py::TestStrategFetching::test_fetch_strategies_generic_exception PASSED [ 66%]
tests/test_reporter.py::TestFormatting::test_format_new_buys_table_empty PASSED [ 67%]
tests/test_reporter.py::TestFormatting::test_format_open_positions_table_empty PASSED [ 67%]
tests/test_reporter.py::TestFormatting::test_format_sell_positions_table_empty PASSED [ 67%]
tests/test_reporter.py::TestFormatting::test_format_open_positions_table_with_na PASSED [ 67%]
tests/test_reporter.py::TestFormatting::test_format_strategy_analysis_as_csv PASSED [ 67%]
tests/test_reporter.py::TestFormatting::test_format_strategy_analysis_as_csv_empty PASSED [ 68%]
tests/test_reporter.py::TestStrategyAnalysis::test_analyze_strategy_performance_basic PASSED [ 68%]
tests/test_reporter.py::TestStrategyAnalysis::test_analyze_strategy_performance_aggregated_empty_records PASSED [ 68%]
tests/test_reporter.py::TestErrorHandling::test_analyze_strategy_performance_db_error PASSED [ 68%]
tests/test_reporter.py::TestErrorHandling::test_analyze_strategy_performance_aggregated_db_error PASSED [ 69%]
tests/test_reporter.py::TestErrorHandling::test_fetch_best_strategies_connection_error PASSED [ 69%]
tests/test_reporter.py::TestErrorHandling::test_fetch_best_strategies_sql_error PASSED [ 69%]
tests/test_reporter.py::TestErrorHandling::test_find_signals_empty_rule_stack PASSED [ 69%]
tests/test_reporter.py::TestErrorHandling::test_find_signals_empty_dataframe PASSED [ 69%]
tests/test_reporter.py::TestErrorHandling::test_find_signals_rule_function_error PASSED [ 70%]
tests/test_reporter.py::TestErrorHandling::test_find_signals_string_parameter_conversion PASSED [ 70%]
tests/test_reporter.py::TestReportGeneration::test_generate_report_with_positions PASSED [ 70%]
tests/test_reporter.py::TestReportGeneration::test_generate_report_file_write_error PASSED [ 70%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_invalid_entry_price PASSED [ 71%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_stop_loss_pct PASSED [ 71%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_take_profit_pct PASSED [ 71%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_stop_loss_atr PASSED [ 71%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_take_profit_atr PASSED [ 71%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_sma_cross_under PASSED [ 72%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_sma_crossover PASSED [ 72%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_time_based_exit PASSED [ 72%]
tests/test_reporter.py::TestExitConditionChecking::test_check_exit_conditions_with_object_conditions PASSED [ 72%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_get_position_pricing_success PASSED [ 72%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_get_position_pricing_no_data PASSED [ 73%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_get_position_pricing_exception PASSED [ 73%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_calculate_position_returns_basic PASSED [ 73%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_calculate_position_returns_invalid_entry_price PASSED [ 73%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_calculate_position_returns_with_nifty_data PASSED [ 74%]
tests/test_reporter.py::TestPositionPricingAndCalculations::test_calculate_position_returns_nifty_error PASSED [ 74%]
tests/test_reporter.py::test_fetch_strategies_threshold_variations[0.5-2] PASSED [ 74%]
tests/test_reporter.py::test_fetch_strategies_threshold_variations[0.7-1] PASSED [ 74%]
tests/test_reporter.py::test_fetch_strategies_threshold_variations[0.8-0] PASSED [ 74%]
tests/test_reporter.py::TestPositionProcessing::test_process_open_positions_basic PASSED [ 75%]
tests/test_reporter.py::TestPositionProcessing::test_process_open_positions_no_pricing PASSED [ 75%]
tests/test_reporter.py::TestPositionProcessing::test_identify_new_signals_basic PASSED [ 75%]
tests/test_reporter.py::TestPositionProcessing::test_identify_new_signals_empty_results PASSED [ 75%]
tests/test_reporter.py::TestPositionProcessing::test_update_positions_and_generate_report_data PASSED [ 76%]
tests/test_reporter.py::TestPositionProcessing::test_update_positions_nifty_data_error PASSED [ 76%]
tests/test_reporter.py::TestAdvancedFormatting::test_format_new_buys_table_with_missing_fields PASSED [ 76%]
tests/test_reporter.py::TestAdvancedFormatting::test_format_open_positions_with_extreme_values PASSED [ 76%]
tests/test_reporter.py::TestAdvancedFormatting::test_format_sell_positions_with_missing_exit_reason PASSED [ 76%]
tests/test_reporter.py::TestAdvancedFormatting::test_generate_daily_report_comprehensive PASSED [ 77%]
tests/test_reporter.py::test_csv_formatting_variations[standard-False] PASSED [ 77%]
tests/test_reporter.py::test_csv_formatting_variations[aggregated-True] PASSED [ 77%]
tests/test_reporter.py::TestReporterEdgeCases::test_walk_forward_report_empty_oos_results PASSED [ 77%]
tests/test_reporter.py::TestReporterEdgeCases::test_walk_forward_report_with_nan_values PASSED [ 77%]
tests/test_reporter.py::TestReporterEdgeCases::test_walk_forward_report_single_oos_period PASSED [ 78%]
tests/test_reporter.py::TestReporterEdgeCases::test_walk_forward_report_zero_trades_period PASSED [ 78%]
tests/test_reporter.py::TestReporterEdgeCases::test_format_table_functions_with_none_values PASSED [ 78%]
tests/test_reporter.py::TestReporterEdgeCases::test_analyze_strategy_performance_db_error PASSED [ 78%]
tests/test_reporter.py::TestReporterEdgeCases::test_analyze_strategy_performance_aggregated_db_error PASSED [ 79%]
tests/test_reporter.py::TestReporterEdgeCases::test_format_strategy_analysis_as_csv_empty_data PASSED [ 79%]
tests/test_reporter.py::TestReporterEdgeCases::test_analyze_strategy_performance_aggregated_empty_records PASSED [ 79%]
tests/test_reporter.py::TestReporterEdgeCases::test_walk_forward_report_calculation_edge_cases PASSED [ 79%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_check_exit_conditions_comprehensive_coverage PASSED [ 79%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_get_position_pricing_all_scenarios PASSED [ 80%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_calculate_position_returns_comprehensive PASSED [ 80%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_process_open_positions_edge_cases PASSED [ 80%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_identify_new_signals_comprehensive PASSED [ 80%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_format_strategy_analysis_comprehensive PASSED [ 81%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_generate_daily_report_error_scenarios PASSED [ 81%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_analysis_functions_with_malformed_data PASSED [ 81%]
tests/test_reporter.py::TestReporterAdditionalEdgeCases::test_database_connection_errors PASSED [ 81%]
tests/test_ruledef_get_bug_fix.py::TestRuleDefBugFixes::test_generate_report_handles_ruledef_objects PASSED [ 81%]
tests/test_ruledef_get_bug_fix.py::TestRuleDefBugFixes::test_generate_report_handles_mixed_rule_formats PASSED [ 82%]
tests/test_ruledef_get_bug_fix.py::TestRuleDefBugFixes::test_generate_report_handles_rules_without_name PASSED [ 82%]
tests/test_ruledef_get_bug_fix.py::TestRuleDefBugFixes::test_process_open_positions_uses_config_years PASSED [ 82%]
tests/test_ruledef_get_bug_fix.py::TestRuleDefBugFixes::test_price_data_fetch_uses_config_years_with_position PASSED [ 82%]
tests/test_rules.py::TestSMACrossover::test_valid_crossover_signal PASSED [ 83%]
tests/test_rules.py::TestSMACrossover::test_insufficient_data PASSED     [ 83%]
tests/test_rules.py::TestSMACrossover::test_invalid_periods PASSED       [ 83%]
tests/test_rules.py::TestCalculateRSI::test_rsi_calculation PASSED       [ 83%]
tests/test_rules.py::TestCalculateRSI::test_rsi_insufficient_data PASSED [ 83%]
tests/test_rules.py::TestRSIOversold::test_oversold_signal_generation PASSED [ 84%]
tests/test_rules.py::TestRSIOversold::test_insufficient_data_rsi PASSED  [ 84%]
tests/test_rules.py::TestEMACrossover::test_ema_crossover_signal PASSED  [ 84%]
tests/test_rules.py::TestEdgeCases::test_empty_dataframe PASSED          [ 84%]
tests/test_rules.py::TestEdgeCases::test_single_price_data PASSED        [ 84%]
tests/test_rules.py::TestEdgeCases::test_nan_price_data PASSED           [ 85%]
tests/test_rules.py::TestIntegration::test_all_rules_with_real_data PASSED [ 85%]
tests/test_rules.py::TestVolumeSpike::test_volume_spike_detection PASSED [ 85%]
tests/test_rules.py::TestVolumeSpike::test_volume_spike_insufficient_data PASSED [ 85%]
tests/test_rules.py::TestVolumeSpike::test_volume_spike_invalid_params PASSED [ 86%]
tests/test_rules.py::TestVolumeSpike::test_volume_spike_missing_columns PASSED [ 86%]
tests/test_rules.py::TestHammerPattern::test_hammer_pattern_detection PASSED [ 86%]
tests/test_rules.py::TestHammerPattern::test_hammer_pattern_empty_data PASSED [ 86%]
tests/test_rules.py::TestHammerPattern::test_hammer_pattern_invalid_params PASSED [ 86%]
tests/test_rules.py::TestHammerPattern::test_hammer_pattern_missing_columns PASSED [ 87%]
tests/test_rules.py::TestEngulfingPattern::test_engulfing_pattern_detection PASSED [ 87%]
tests/test_rules.py::TestEngulfingPattern::test_engulfing_pattern_insufficient_data PASSED [ 87%]
tests/test_rules.py::TestEngulfingPattern::test_engulfing_pattern_invalid_params PASSED [ 87%]
tests/test_rules.py::TestEngulfingPattern::test_engulfing_pattern_missing_columns PASSED [ 88%]
tests/test_rules.py::TestMACDCrossover::test_macd_crossover_signal PASSED [ 88%]
tests/test_rules.py::TestMACDCrossover::test_macd_crossover_insufficient_data PASSED [ 88%]
tests/test_rules.py::TestMACDCrossover::test_macd_crossover_invalid_params PASSED [ 88%]
tests/test_rules.py::TestMACDCrossover::test_macd_crossover_missing_columns PASSED [ 88%]
tests/test_rules.py::TestBollingerSqueeze::test_bollinger_squeeze_signal PASSED [ 89%]
tests/test_rules.py::TestBollingerSqueeze::test_bollinger_squeeze_insufficient_data PASSED [ 89%]
tests/test_rules.py::TestBollingerSqueeze::test_bollinger_squeeze_invalid_params PASSED [ 89%]
tests/test_rules.py::TestBollingerSqueeze::test_bollinger_squeeze_missing_columns PASSED [ 89%]
tests/test_rules.py::TestNewRulesIntegration::test_all_new_rules_with_sample_data PASSED [ 89%]
tests/test_rules.py::test_sma_cross_under_basic PASSED                   [ 90%]
tests/test_rules.py::test_sma_cross_under_parameter_validation PASSED    [ 90%]
tests/test_rules.py::test_stop_loss_pct_validation PASSED                [ 90%]
tests/test_rules.py::test_take_profit_pct_validation PASSED              [ 90%]
tests/test_rules.py::test_sma_cross_under_insufficient_data PASSED       [ 91%]
tests/test_rules.py::test_calculate_atr_basic PASSED                     [ 91%]
tests/test_rules.py::test_calculate_atr_mathematical_accuracy PASSED     [ 91%]
tests/test_rules.py::test_calculate_atr_insufficient_data PASSED         [ 91%]
tests/test_rules.py::test_calculate_atr_missing_columns PASSED           [ 91%]
tests/test_rules.py::test_calculate_atr_invalid_period PASSED            [ 92%]
tests/test_rules.py::test_stop_loss_atr_basic PASSED                     [ 92%]
tests/test_rules.py::test_stop_loss_atr_not_triggered PASSED             [ 92%]
tests/test_rules.py::test_stop_loss_atr_invalid_params PASSED            [ 92%]
tests/test_rules.py::test_stop_loss_atr_insufficient_data PASSED         [ 93%]
tests/test_rules.py::TestMarketAboveSMA::test_bullish_market_detection PASSED [ 93%]
tests/test_rules.py::TestMarketAboveSMA::test_bearish_market_detection PASSED [ 93%]
tests/test_rules.py::TestMarketAboveSMA::test_mixed_market_conditions PASSED [ 93%]
tests/test_rules.py::TestMarketAboveSMA::test_different_sma_periods PASSED [ 93%]
tests/test_rules.py::TestMarketAboveSMA::test_insufficient_data_handling PASSED [ 94%]
tests/test_rules.py::TestMarketAboveSMA::test_parameter_validation PASSED [ 94%]
tests/test_rules.py::TestMarketAboveSMA::test_missing_required_columns PASSED [ 94%]
tests/test_rules.py::TestMarketAboveSMA::test_empty_dataframe_handling PASSED [ 94%]
tests/test_rules.py::TestMarketAboveSMA::test_nan_values_handling PASSED [ 94%]
tests/test_rules.py::TestMarketAboveSMA::test_crossover_scenarios PASSED [ 95%]
tests/test_rules.py::TestMarketAboveSMA::test_edge_case_single_data_point PASSED [ 95%]
tests/test_rules.py::TestMarketAboveSMA::test_mathematical_accuracy PASSED [ 95%]
tests/test_rules.py::TestMarketAboveSMA::test_performance_with_large_dataset PASSED [ 95%]
tests/test_rules.py::test_take_profit_atr_basic PASSED                   [ 96%]
tests/test_rules.py::test_take_profit_atr_not_triggered PASSED           [ 96%]
tests/test_rules.py::test_take_profit_atr_invalid_params PASSED          [ 96%]
tests/test_rules.py::test_take_profit_atr_insufficient_data PASSED       [ 96%]
tests/test_rules.py::test_atr_functions_empty_data PASSED                [ 96%]
tests/test_rules.py::test_atr_consistency_across_functions PASSED        [ 97%]
tests/test_rules.py::test_price_above_long_sma_basic PASSED              [ 97%]
tests/test_rules.py::test_price_above_long_sma_insufficient_data PASSED  [ 97%]
tests/test_rules.py::test_price_above_long_sma_invalid_parameters PASSED [ 97%]
tests/test_rules.py::test_price_above_long_sma_missing_columns PASSED    [ 98%]
tests/test_rules.py::test_is_volatile_basic PASSED                       [ 98%]
tests/test_rules.py::test_is_volatile_insufficient_data PASSED           [ 98%]
tests/test_rules.py::test_is_volatile_invalid_parameters PASSED          [ 98%]
tests/test_rules.py::test_is_volatile_missing_columns PASSED             [ 98%]
tests/test_rules.py::test_is_volatile_mathematical_accuracy PASSED       [ 99%]
tests/test_rules.py::test_is_volatile_zero_volatility PASSED             [ 99%]
tests/test_rules.py::TestATRExitFunctionsFix::test_atr_exit_functions_skipped_in_signal_generation PASSED [ 99%]
tests/test_rules.py::TestATRExitFunctionsFix::test_only_atr_exit_functions_returns_no_signals PASSED [ 99%]
tests/test_rules.py::TestATRExitFunctionsFix::test_mixed_rule_stack_with_atr_functions PASSED [100%]

=============================== tests coverage ================================
______________ coverage: platform win32, python 3.12.10-final-0 _______________

Name                                   Stmts   Miss Branch BrPart  Cover
------------------------------------------------------------------------
src\kiss_signal\__init__.py                5      0      0      0   100%
src\kiss_signal\adapters\__init__.py       1      0      0      0   100%
src\kiss_signal\adapters\yfinance.py      55      0     20      0   100%
src\kiss_signal\backtester.py            518     93    216     25    80%
src\kiss_signal\cli.py                   270     11     62      8    94%
src\kiss_signal\config.py                 90      3     14      2    95%
src\kiss_signal\data.py                  229     28     94     13    87%
src\kiss_signal\exceptions.py              6      0      0      0   100%
src\kiss_signal\performance.py            41      0      4      0   100%
src\kiss_signal\persistence.py           252     14     46      7    93%
src\kiss_signal\reporter.py              474     60    154     19    86%
src\kiss_signal\rules.py                 311     12    110      7    95%
------------------------------------------------------------------------
TOTAL                                   2252    221    720     81    89%
======================= 459 passed in 129.16s (0:02:09) =======================
