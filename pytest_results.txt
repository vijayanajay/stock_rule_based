============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-8.4.0, pluggy-1.6.0 -- D:\Code\stock_rule_based\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Code\stock_rule_based
configfile: pyproject.toml
plugins: cov-6.2.1
collecting ... collected 91 items

tests/test_backtester.py::TestBacktester::test_init_default_parameters PASSED [  1%]
tests/test_backtester.py::TestBacktester::test_init_custom_parameters PASSED [  2%]
tests/test_backtester.py::TestBacktester::test_calc_edge_score_basic PASSED [  3%]
tests/test_backtester.py::TestBacktester::test_calc_edge_score_zero_values PASSED [  4%]
tests/test_backtester.py::TestBacktester::test_generate_signals_empty_rule_stack PASSED [  5%]
tests/test_backtester.py::TestBacktester::test_generate_signals_sma_crossover PASSED [  6%]
tests/test_backtester.py::TestBacktester::test_generate_signals_invalid_rule PASSED [  7%]
tests/test_backtester.py::TestBacktester::test_generate_signals_missing_parameters PASSED [  8%]
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_basic_flow PASSED [  9%]
tests/test_backtester.py::TestBacktesterFixtures::test_sample_backtest_data_fixture PASSED [ 10%]
tests/test_cli.py::test_cli_import PASSED                                [ 12%]
tests/test_cli.py::test_run_command_help PASSED                          [ 13%]
tests/test_cli.py::test_run_command_basic PASSED                         [ 14%]
tests/test_cli.py::test_run_command_verbose PASSED                       [ 15%]
tests/test_cli.py::test_run_command_freeze_date PASSED                   [ 16%]
tests/test_cli.py::test_run_command_success PASSED                       [ 17%]
tests/test_cli.py::test_run_command_invalid_freeze_date PASSED           [ 18%]
tests/test_cli.py::test_run_command_no_config PASSED                     [ 19%]
tests/test_cli.py::test_run_command_missing_rules PASSED                 [ 20%]
tests/test_cli.py::test_run_command_with_persistence PASSED              [ 21%]
tests/test_cli.py::test_run_command_persistence_failure_handling PASSED  [ 23%]
tests/test_config.py::test_config_model_valid PASSED                     [ 24%]
tests/test_config.py::test_config_model_invalid_weights PASSED           [ 25%]
tests/test_config.py::test_load_config_missing_file PASSED               [ 26%]
tests/test_data.py::TestDataFunctions::test_load_universe PASSED         [ 27%]
tests/test_data.py::TestDataFunctions::test_load_universe_missing_file PASSED [ 28%]
tests/test_data.py::TestDataFunctions::test_load_universe_malformed PASSED [ 29%]
tests/test_data.py::TestDataFunctions::test_add_ns_suffix PASSED         [ 30%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_missing_file PASSED [ 31%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_fresh_file PASSED [ 32%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_stale_file PASSED [ 34%]
tests/test_data.py::TestDataFunctions::test_validate_data_quality_good_data PASSED [ 35%]
tests/test_data.py::TestDataFunctions::test_validate_data_quality_negative_prices PASSED [ 36%]
tests/test_data.py::TestDataFunctions::test_save_and_load_symbol_cache PASSED [ 37%]
tests/test_data.py::TestDataFunctions::test_get_price_data_with_date_filtering PASSED [ 38%]
tests/test_data.py::TestDataFunctions::test_get_price_data_with_freeze_date PASSED [ 39%]
tests/test_data.py::TestDataFunctions::test_get_price_data_missing_cache PASSED [ 40%]
tests/test_data.py::TestDataFunctions::test_refresh_market_data_freeze_mode PASSED [ 41%]
tests/test_data.py::TestDataFunctions::test_refresh_market_data_success PASSED [ 42%]
tests/test_data.py::TestDataFunctions::test_fetch_symbol_data_multiindex_columns PASSED [ 43%]
tests/test_data.py::TestDataFunctions::test_fetch_symbol_data_tuple_columns PASSED [ 45%]
tests/test_integration.py::TestCLIIntegration::test_config_loading_integration PASSED [ 46%]
tests/test_integration.py::TestCLIIntegration::test_data_loading_integration PASSED [ 47%]
tests/test_integration.py::TestCLIIntegration::test_backtester_with_real_rules PASSED [ 48%]
tests/test_integration.py::TestCLIIntegration::test_end_to_end_cli_workflow PASSED [ 49%]
tests/test_integration.py::TestCLIIntegration::test_error_handling_integration PASSED [ 50%]
tests/test_integration.py::TestBacktesterRuleIntegration::test_rule_function_lookup PASSED [ 51%]
tests/test_integration.py::TestBacktesterRuleIntegration::test_rule_parameter_validation PASSED [ 52%]
tests/test_performance.py::TestPerformanceMonitor::test_performance_decorator PASSED [ 53%]
tests/test_performance.py::TestPerformanceMonitor::test_threshold_warnings PASSED [ 54%]
tests/test_performance.py::TestPerformanceMonitor::test_memory_monitoring PASSED [ 56%]
tests/test_performance.py::TestIntelligentCache::test_cache_hit_miss PASSED [ 57%]
tests/test_performance.py::TestIntelligentCache::test_cached_decorator PASSED [ 58%]
tests/test_performance.py::TestIntelligentCache::test_cache_cleanup PASSED [ 59%]
tests/test_performance.py::TestBacktesterPerformance::test_backtester_performance_within_limits PASSED [ 60%]
tests/test_performance.py::TestBacktesterPerformance::test_strategy_validation_comprehensive PASSED [ 61%]
tests/test_performance.py::TestBacktesterPerformance::test_market_regime_detection PASSED [ 62%]
tests/test_performance.py::TestPerformanceBenchmarks::test_full_workflow_performance SKIPPED [ 63%]
tests/test_persistence.py::TestCreateDatabase::test_create_database_success PASSED [ 64%]
tests/test_persistence.py::TestCreateDatabase::test_create_database_idempotent PASSED [ 65%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_success PASSED [ 67%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_empty_list PASSED [ 68%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_transaction_rollback PASSED [ 69%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_invalid_rule_stack PASSED [ 70%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_batch_database_not_exists PASSED [ 71%]
tests/test_persistence.py::TestSaveStrategiesBatch::test_save_strategies_multiple_batches PASSED [ 72%]
tests/test_persistence.py::TestIntegration::test_create_and_save_workflow PASSED [ 73%]
tests/test_reporter.py::TestFetchBestStrategies::test_fetch_strategies_success PASSED [ 74%]
tests/test_reporter.py::TestFetchBestStrategies::test_fetch_strategies_threshold_filtering PASSED [ 75%]
tests/test_reporter.py::TestFetchBestStrategies::test_fetch_strategies_no_results PASSED [ 76%]
tests/test_reporter.py::TestFetchBestStrategies::test_fetch_strategies_database_error PASSED [ 78%]
tests/test_reporter.py::TestCheckForSignal::test_check_signal_with_valid_rule PASSED [ 79%]
tests/test_reporter.py::TestCheckForSignal::test_check_signal_no_signal PASSED [ 80%]
tests/test_reporter.py::TestCheckForSignal::test_check_signal_empty_data PASSED [ 81%]
tests/test_reporter.py::TestCheckForSignal::test_check_signal_unknown_rule PASSED [ 82%]
tests/test_reporter.py::TestCheckForSignal::test_check_signal_rule_exception PASSED [ 83%]
tests/test_reporter.py::TestIdentifyNewSignals::test_identify_signals_success PASSED [ 84%]
tests/test_reporter.py::TestIdentifyNewSignals::test_identify_signals_no_strategies PASSED [ 85%]
tests/test_reporter.py::TestGenerateDailyReport::test_generate_report_with_positions PASSED [ 86%]
tests/test_rule_funcs.py::TestSMACrossover::test_valid_crossover_signal PASSED [ 87%]
tests/test_rule_funcs.py::TestSMACrossover::test_insufficient_data PASSED [ 89%]
tests/test_rule_funcs.py::TestSMACrossover::test_invalid_periods PASSED  [ 90%]
tests/test_rule_funcs.py::TestCalculateRSI::test_rsi_calculation PASSED  [ 91%]
tests/test_rule_funcs.py::TestCalculateRSI::test_rsi_insufficient_data PASSED [ 92%]
tests/test_rule_funcs.py::TestRSIOversold::test_oversold_signal_generation PASSED [ 93%]
tests/test_rule_funcs.py::TestRSIOversold::test_insufficient_data_rsi PASSED [ 94%]
tests/test_rule_funcs.py::TestEMACrossover::test_ema_crossover_signal PASSED [ 95%]
tests/test_rule_funcs.py::TestEdgeCases::test_empty_dataframe PASSED     [ 96%]
tests/test_rule_funcs.py::TestEdgeCases::test_single_price_data PASSED   [ 97%]
tests/test_rule_funcs.py::TestEdgeCases::test_nan_price_data PASSED      [ 98%]
tests/test_rule_funcs.py::TestIntegration::test_all_rules_with_real_data PASSED [100%]

============================== warnings summary ===============================
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_basic_flow
tests/test_backtester.py::TestBacktesterIntegration::test_find_optimal_strategies_basic_flow
  D:\Code\stock_rule_based\src\kiss_signal\cache.py:75: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("""

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
______________ coverage: platform win32, python 3.12.10-final-0 _______________

Name                             Stmts   Miss  Cover
----------------------------------------------------
src\kiss_signal\__init__.py          4      0   100%
src\kiss_signal\_version.py         13     13     0%
src\kiss_signal\backtester.py      185     95    49%
src\kiss_signal\cache.py            74      9    88%
src\kiss_signal\cli.py             209     83    60%
src\kiss_signal\config.py           68     11    84%
src\kiss_signal\data.py            160     40    75%
src\kiss_signal\performance.py      52      6    88%
src\kiss_signal\persistence.py     118     17    86%
src\kiss_signal\reporter.py        206     43    79%
src\kiss_signal\rules.py            79     26    67%
----------------------------------------------------
TOTAL                             1168    343    71%
================= 90 passed, 1 skipped, 2 warnings in 29.63s ==================
