============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-8.4.0, pluggy-1.6.0 -- D:\Code\stock_rule_based\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Code\stock_rule_based
configfile: pyproject.toml
plugins: cov-6.2.1
collecting ... collected 75 items

tests/test_cli.py::test_cli_import PASSED                                [  1%]
tests/test_cli.py::test_help_command PASSED                              [  2%]
tests/test_cli.py::test_run_command_basic PASSED                         [  4%]
tests/test_cli.py::test_run_command_verbose PASSED                       [  5%]
tests/test_cli.py::test_run_command_freeze_date PASSED                   [  6%]
tests/test_cli.py::test_run_command_success PASSED                       [  8%]
tests/test_cli.py::test_run_command_with_freeze_date PASSED              [  9%]
tests/test_cli.py::test_run_command_invalid_freeze_date PASSED           [ 10%]
tests/test_cli.py::test_run_command_no_config PASSED                     [ 12%]
tests/test_cli.py::test_run_command_missing_rules PASSED                 [ 13%]
tests/test_config.py::test_edge_score_weights_valid PASSED               [ 14%]
tests/test_config.py::test_edge_score_weights_invalid_sum PASSED         [ 16%]
tests/test_config.py::test_config_validation PASSED                      [ 17%]
tests/test_config.py::test_load_config PASSED                            [ 18%]
tests/test_config.py::test_load_config_missing_file PASSED               [ 20%]
tests/test_config.py::TestConfig::test_config_defaults PASSED            [ 21%]
tests/test_config.py::TestConfig::test_config_validation_historical_years PASSED [ 22%]
tests/test_config.py::TestConfig::test_config_validation_cache_refresh_days PASSED [ 24%]
tests/test_config.py::TestConfig::test_config_universe_path_validation PASSED [ 25%]
tests/test_config.py::TestConfig::test_config_freeze_date PASSED         [ 26%]
tests/test_config.py::TestLoadConfig::test_load_config_success PASSED    [ 28%]
tests/test_config.py::TestLoadConfig::test_load_config_missing_file PASSED [ 29%]
tests/test_config.py::TestLoadConfig::test_load_config_invalid_yaml PASSED [ 30%]
tests/test_config.py::TestLoadConfig::test_load_config_with_freeze_date PASSED [ 32%]
tests/test_data.py::TestDataFunctions::test_load_universe PASSED         [ 33%]
tests/test_data.py::TestDataFunctions::test_load_universe_missing_file PASSED [ 34%]
tests/test_data.py::TestDataFunctions::test_load_universe_malformed PASSED [ 36%]
tests/test_data.py::TestDataFunctions::test_add_ns_suffix PASSED         [ 37%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_missing_file PASSED [ 38%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_fresh_file PASSED [ 40%]
tests/test_data.py::TestDataFunctions::test_needs_refresh_stale_file PASSED [ 41%]
tests/test_data.py::TestDataFunctions::test_validate_data_quality_good_data PASSED [ 42%]
tests/test_data.py::TestDataFunctions::test_validate_data_quality_negative_prices PASSED [ 44%]
tests/test_data.py::TestDataFunctions::test_save_and_load_symbol_cache PASSED [ 45%]
tests/test_data.py::TestDataFunctions::test_get_price_data_with_date_filtering PASSED [ 46%]
tests/test_data.py::TestDataFunctions::test_get_price_data_with_freeze_date PASSED [ 48%]
tests/test_data.py::TestDataFunctions::test_get_price_data_missing_cache PASSED [ 49%]
tests/test_data.py::TestDataFunctions::test_refresh_market_data_freeze_mode PASSED [ 50%]
tests/test_data.py::TestDataFunctions::test_refresh_market_data_success PASSED [ 52%]
tests/test_data_manager.py::TestDataManager::test_load_universe PASSED   [ 53%]
tests/test_data_manager.py::TestDataManager::test_load_universe_missing_file PASSED [ 54%]
tests/test_data_manager.py::TestDataManager::test_load_universe_malformed PASSED [ 56%]
tests/test_data_manager.py::TestDataManager::test_needs_refresh PASSED   [ 57%]
tests/test_data_manager.py::TestDataManager::test_add_ns_suffix PASSED   [ 58%]
tests/test_data_manager.py::TestDataManager::test_validate_data_quality PASSED [ 60%]
tests/test_data_manager.py::TestDataManager::test_fetch_symbol_data_success PASSED [ 61%]
tests/test_data_manager.py::TestDataManager::test_fetch_symbol_data_failure PASSED [ 62%]
tests/test_data_manager.py::TestDataManager::test_save_and_load_symbol_cache PASSED [ 64%]
tests/test_data_manager.py::TestDataManager::test_get_price_data_with_date_filtering PASSED [ 65%]
tests/test_data_manager.py::TestDataManager::test_get_price_data_with_freeze_date PASSED [ 66%]
tests/test_data_manager.py::TestDataManager::test_get_price_data_missing_cache PASSED [ 68%]
tests/test_data_manager.py::TestDataManager::test_refresh_market_data PASSED [ 69%]
tests/test_data_manager.py::TestDataConfiguration::test_freeze_date_integration PASSED [ 70%]
tests/test_data_manager.py::TestDataConfiguration::test_custom_cache_refresh_days PASSED [ 72%]
tests/test_rule_funcs.py::TestSMACrossover::test_valid_crossover_signal PASSED [ 73%]
tests/test_rule_funcs.py::TestSMACrossover::test_insufficient_data PASSED [ 74%]
tests/test_rule_funcs.py::TestSMACrossover::test_invalid_periods PASSED  [ 76%]
tests/test_rule_funcs.py::TestCalculateRSI::test_rsi_calculation PASSED  [ 77%]
tests/test_rule_funcs.py::TestCalculateRSI::test_rsi_insufficient_data PASSED [ 78%]
tests/test_rule_funcs.py::TestRSIOversold::test_oversold_signal_generation PASSED [ 80%]
tests/test_rule_funcs.py::TestRSIOversold::test_insufficient_data_rsi PASSED [ 81%]
tests/test_rule_funcs.py::TestEMACrossover::test_ema_crossover_signal PASSED [ 82%]
tests/test_rule_funcs.py::TestRuleValidation::test_valid_sma_params PASSED [ 84%]
tests/test_rule_funcs.py::TestRuleValidation::test_default_param_substitution PASSED [ 85%]
tests/test_rule_funcs.py::TestRuleValidation::test_invalid_rule_type PASSED [ 86%]
tests/test_rule_funcs.py::TestRuleValidation::test_invalid_param_types PASSED [ 88%]
tests/test_rule_funcs.py::TestRuleValidation::test_param_range_validation PASSED [ 89%]
tests/test_rule_funcs.py::TestRuleValidation::test_logical_validation PASSED [ 90%]
tests/test_rule_funcs.py::TestRuleRegistry::test_registry_completeness PASSED [ 92%]
tests/test_rule_funcs.py::TestRuleRegistry::test_get_rule_function PASSED [ 93%]
tests/test_rule_funcs.py::TestRuleRegistry::test_get_unknown_rule_function PASSED [ 94%]
tests/test_rule_funcs.py::TestEdgeCases::test_empty_dataframe PASSED     [ 96%]
tests/test_rule_funcs.py::TestEdgeCases::test_single_price_data PASSED   [ 97%]
tests/test_rule_funcs.py::TestEdgeCases::test_nan_price_data PASSED      [ 98%]
tests/test_rule_funcs.py::TestIntegration::test_all_rules_with_real_data PASSED [100%]

=============================== tests coverage ================================
______________ coverage: platform win32, python 3.12.10-final-0 _______________

Name                                  Stmts   Miss  Cover
---------------------------------------------------------
src\kiss_signal\__init__.py               4      0   100%
src\kiss_signal\_version.py              13     13     0%
src\kiss_signal\backtester.py            17     17     0%
src\kiss_signal\cli.py                   49      3    94%
src\kiss_signal\config.py               100      7    93%
src\kiss_signal\data.py                 152     26    83%
src\kiss_signal\data_manager.py          24     24     0%
src\kiss_signal\engine.py                18     10    44%
src\kiss_signal\persistence.py           19     19     0%
src\kiss_signal\reporter.py              25     25     0%
src\kiss_signal\rules.py                 48      3    94%
src\kiss_signal\signal_generator.py      30     30     0%
---------------------------------------------------------
TOTAL                                   499    177    65%
============================= 75 passed in 4.97s ==============================
