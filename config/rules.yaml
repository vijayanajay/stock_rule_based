# =============================================================================
# REVISED STRATEGY: EXTREME-Conviction Pullback in a Bull Market
#
# THESIS: The previous strategy was too loose. We will now ONLY buy a
# VIOLENT bullish reversal pattern during a short-term pullback, backed by
# OVERWHELMING evidence. We will be far more selective and take profits sooner.
# =============================================================================

# -----------------------------------------------------------------------------
# CONTEXT FILTERS: No change. This is sound. Don't trade against the market.
# -----------------------------------------------------------------------------
context_filters:
  - name: "filter_market_is_bullish"
    type: "market_above_sma"
    description: "Context 1: Don't fight the tape. The NIFTY 50 index must be above its 50-day SMA."
    params:
      index_symbol: "^NSEI"
      period: 50

# -----------------------------------------------------------------------------
# BASELINE SIGNAL: Make the entry signal EXTREMELY selective.
# -----------------------------------------------------------------------------
baseline:
  name: "strong_bullish_engulfing"
  type: "engulfing_pattern"
  description: "Baseline: Enter on an EXTREMELY strong bullish engulfing pattern. The body of the green candle must be at least 2.5x the prior red candle."
  params:
    min_body_ratio: 2.5  # TIGHTENED from 1.5. We only want explosive reversals.

# -----------------------------------------------------------------------------
# LAYERS: Simplify and tighten. Remove what doesn't work.
# -----------------------------------------------------------------------------
layers:
  # DELETED: The RSI layer is proven ineffective by the performance report. Kill it.
  # - name: "confirm_with_rsi_recovering" ...

  - name: "confirm_with_extreme_volume"
    type: "volume_spike"
    description: "Confirmation 1: The reversal must be backed by overwhelming volume (3x average)."
    params:
      period: 20
      spike_multiplier: 3.0  # TIGHTENED from 2.0. We need institutional conviction.
      price_change_threshold: 0.01

  - name: "confirm_with_medium_term_uptrend"
    type: "price_above_sma"
    description: "Confirmation 2: The stock itself must be in a medium-term uptrend (Price > 50-day SMA)."
    params:
      period: 50 # No change. This is a sound rule.

# -----------------------------------------------------------------------------
# SELL CONDITIONS: Be more realistic.
# -----------------------------------------------------------------------------
sell_conditions:
  # --- Primary Risk Management ---
  - name: "atr_stop_loss_1.5x"
    type: "stop_loss_atr"
    description: "RISK 1 (Tighter Stop): Exit if price drops 1.5x ATR. The old 2x stop allowed too much loss."
    params:
      period: 14
      multiplier: 1.5 # TIGHTENED from 2.0. Cut losses faster.

  # --- Trend Failure Exit ---
  - name: "trend_reversal_exit"
    type: "sma_cross_under"
    description: "RISK 2 (Trend Failure): Exit if the short-term trend breaks (10d SMA < 20d SMA)."
    params:
      fast_period: 10
      slow_period: 20

  # --- Profit Target ---
  - name: "atr_take_profit_3x"
    type: "take_profit_atr"
    description: "PROFIT TARGET: Exit if price rises 3x ATR. This still ensures a 2:1 Reward/Risk ratio with our tighter stop."
    params:
      period: 14
      multiplier: 3.0 # REDUCED from 4.0. The data shows 4x is too ambitious. Let's bank profits sooner.